montant de sinistre payé  en fonction du numéro de licence",
x = "Numéro de licence",
y = "Logarithme naturel du montant de sinistre") +
theme_bw() +
theme(plot.title = element_text(hjust = 0.5, face = "bold"))
boxplot_LicenceNb
dataACP <- Datajoined[, c("Payment","OccurDate",
"DrivAge", "DrivGender", "BonusMalus", "LicenceNb",
"VehAge", "VehClass", "VehPower", "VehGas",
"VehUsage", "TPLInVolontary")]
str(dataACP)
# Year vaut 1 si en 2003 et 0 si en 2004
dataACP <- dataACP %>%
mutate(is2003 = ifelse(year(OccurDate) == 2003, 1, 0))
table(dataACP$is2003)
# DrivGender vaut 1 si F et 0 si M
dataACP$isWomen <- dataACP$DrivGender
levels(dataACP$isWomen) <- c("1", "0")
# VehClass classer de 1 à 7, du moins chère au plus chère
dataACP$VehPrice <- dataACP$VehClass
levels(dataACP$VehPrice) <- 1:length(levels(dataACP$VehPrice))
# VehPower classer de 1 à 12, du niveau de power le plus bas au plus haut
dataACP$VehPowerLevel <- dataACP$VehPower
levels(dataACP$VehPowerLevel) <- 1:length(levels(dataACP$VehPowerLevel))
# VehGas avec 1 pour Diesel et 0 pour Regular
dataACP$isDiesel <- dataACP$VehGas
levels(dataACP$isDiesel) <- c("1", "0")
# VehUsage avec 1 pour usage privé et 0 pour usage professionel
dataACP$isPrivateUsage <- dataACP$VehUsage
levels(dataACP$isPrivateUsage) <- c("1", "0")
dataACP <- dataACP[, c("Payment", "is2003",
"DrivAge", "isWomen", "BonusMalus", "LicenceNb",
"VehAge", "VehPrice", "VehPowerLevel", "isDiesel",
"isPrivateUsage", "TPLInVolontary")]
str(dataACP)
var_chr_to_num <- c("is2003", "isWomen", "LicenceNb",
"VehPrice", "VehPowerLevel", "isDiesel",
"isPrivateUsage", "TPLInVolontary")
dataACP[, var_chr_to_num] <- lapply(dataACP[, var_chr_to_num], function(x) as.numeric(as.character(x)))
cormat <- cor(dataACP[, -1], method = "pearson")
library(reshape2)
cormat.long <- melt(cormat)
ggplot(data = cormat.long, aes(Var2, Var1, fill = abs(value))) +
geom_tile() +
scale_y_discrete(limits = rev) +
theme(axis.text.x = element_text(angle = 90))
# en observant la matrice de corrélation, on devrait retirer les variables
# is2003, isPrivateUsage et TPLVolontary car elles n'ont aucune corrélation avec
# les autres variables
dataACP[ ,c("is2003", "isPrivateUsage", "TPLInVolontary")] <- list(NULL)
acp <- PCA(dataACP[, -1], scale = TRUE)
eblouis_ACP <- fviz_screeplot(acp) +
labs(title = "",
x = "Dimensions",
y = "Pourcentage de variance expliquée")
eblouis_ACP
# Je dirais ici que le coude est à 4 ou 6 dimensions.
df_variance <- acp$eig[, c("percentage of variance", "cumulative percentage of variance")]
df_variance <- cbind(1:8, df_variance)
rownames(df_variance) <- 1:8
colnames(df_variance) <- c("Composantes",
"Pourcentage de variance",
"Pourcentage de variance cumulatif")
dataACP <- cbind(dataACP, acp$ind$coord)
g_ind <- ggplot() +
geom_point(data = dataACP,
aes(x = Dim.1, y = Dim.2), alpha = 0.5) +
xlab("Dimension 1") +
ylab("Dimension 2") +
theme_bw() +
theme(plot.title = element_text(hjust = 0.5, face = "bold"))
g_ind
graphACP <- fviz_pca_var(acp,
col.var = "contrib",
gradient.cols = c("#00AFBB", "#E7B800", "#FC4E07"),
repel = TRUE,
title = ""
)
graphACP
weights <- data.frame(acp$var$coord[,1:2])
weights$carac <- rownames(weights)
weights.long <- reshape2::melt(weights)
poids_ACP <- ggplot(weights.long, aes(x=carac, fill=variable, y=value))+
geom_bar(stat="identity",position=PositionDodge)+
facet_grid(~variable)+
theme(legend.position="top",axis.text.x = element_text(angle = 90))+
coord_flip() +
labs(x = "Variable", y = "Poids") +
theme_bw() +
theme(plot.title = element_text(hjust = 0.5, face = "bold"))
print(poids_ACP)
# distance avec daisy car données non numériques
names(Datajoined)
data_hclust <- Datajoined[, c("Payment",
"DrivAge", "DrivGender", "BonusMalus", "LicenceNb",
"PayFreq", "VehAge", "VehClass", "VehPower", "VehGas",
"VehUsage", "Garage", "Region", "Channel",
"Marketing","TPLInVolontary")]
distance <- daisy(data_hclust, type = list(asymm = "TPLInVolontary" ))
set.seed(4114)
sil_moyenne <- sapply(2:8, function(k){
silou <- silhouette(pam(distance,k,nstart = 5, diss = T), distance)
mean(silou[,3])
})
kmedoide <- pam(distance, k_silhouette, nstart = 5,diss = T,distance)
# Avec la méthode de la silhouette, on veut le max.
k_silhouette <- data_silou[which.max(data_silou$silouhette),]$k
data_silou <- data.frame(k = 2:8, silouhette = sil_moyenne)
graph_silhouette_kmedoide <-ggplot(data_silou, aes(x = k, y = sil_moyenne)) +
geom_point() + geom_line() + theme_bw() +
labs( y = "Silhouette moyenne", x = "Nombre de groupe") +
theme(plot.title = element_text(hjust = 0.5, face = "bold"))
graph_silhouette_kmedoide
# Avec la méthode de la silhouette, on veut le max.
k_silhouette <- data_silou[which.max(data_silou$silouhette),]$k
kmedoide <- pam(distance, k_silhouette, nstart = 5,diss = T,distance)
dataACP$groupe_kmedoide <-as.factor(kmedoide$clustering)
graph_kmedoide_acp <- ggplot() +
geom_point(data = dataACP,
aes(x = Dim.1, y = Dim.2, col = groupe_kmedoide), alpha = 0.45) +
xlab("Dimension 1") +
ylab("Dimension 2") +
labs(color = "Groupes K-médoïdes") +
theme_bw() +
theme(plot.title = element_text(hjust = 0.5, face = "bold"))
graph_kmedoide_acp
medoide <- kmedoide$id.med
medoide
Datajoined[c(3069,1138),]
medoide <- kmedoide$id.med
medoide
medoide <- kmedoide$id.med
medoide <- kmedoide$id.med
Datajoined[c(3069,1138),c("Payment, DrivAge", "DrivGender","BonusMalus","VehClass","VehClass","VehPower","VehGas")]
names(Datajoined)
Datajoined[c(3069,1138),c("Payment", "DrivAge", "DrivGender","BonusMalus","VehClass","VehClass","VehPower","VehGas")]
Datajoined[c(3069,1138),c("VehPrice","VehPower","VehGas","VehAge","DrivGender","DrivAge","BonusMalus","LicenseNb")]
names(Datajoined)
Datajoined[c(3069,1138),c("VehPrice","VehPower","VehGas","VehAge","DrivGender","DrivAge","BonusMalus","LicenceNb")]
Datajoined[c(3069,1138),c("VehClass","VehPower","VehGas","VehAge","DrivGender","DrivAge","BonusMalus","LicenceNb")]
medoide_ACP <- dataACP[medoide, c("Dim.1","Dim.2")]
p
graph_kmedoide_acp <- ggplot() +
geom_point(data = dataACP,
aes(x = Dim.1, y = Dim.2, col = groupe_kmedoide), alpha = 0.45) +
geom_point(data =medoide_ACP, x = Dim.1, y = Dim.2, color = "black", shape = 4, size = 4 )
graph_kmedoide_acp <- ggplot() +
geom_point(data = dataACP,
aes(x = Dim.1, y = Dim.2, col = groupe_kmedoide), alpha = 0.45) +
geom_point(data =medoide_ACP, x = Dim.1, y = Dim.2, color = "black", shape = 4, size = 4 )+
xlab("Dimension 1") +
ylab("Dimension 2") +
labs(color = "Groupes K-médoïdes") +
theme_bw() +
theme(plot.title = element_text(hjust = 0.5, face = "bold"))
medoide_ACP
dataACP$groupe_kmedoide <-as.factor(kmedoide$clustering)
medoide <- kmedoide$id.med
medoide_ACP <- dataACP[medoide, c("Dim.1","Dim.2")]
graph_kmedoide_acp <- ggplot() +
geom_point(data = dataACP,
aes(x = Dim.1, y = Dim.2, col = groupe_kmedoide), alpha = 0.45) +
geom_point(data =medoide_ACP, x = Dim.1, y = Dim.2, color = "black", shape = 4, size = 4 )+
xlab("Dimension 1") +
ylab("Dimension 2") +
labs(color = "Groupes K-médoïdes") +
theme_bw() +
theme(plot.title = element_text(hjust = 0.5, face = "bold"))
medoide_ACP
names(medoide_ACP)
graph_kmedoide_acp <- ggplot() +
geom_point(data = dataACP,
aes(x = Dim.1, y = Dim.2, col = groupe_kmedoide), alpha = 0.45) +
geom_point(data =medoide_ACP, aes(x = Dim.1, y = Dim.2, color = "black"), shape = 4, size = 4 )+
xlab("Dimension 1") +
ylab("Dimension 2") +
labs(color = "Groupes K-médoïdes") +
theme_bw() +
theme(plot.title = element_text(hjust = 0.5, face = "bold"))
graph_kmedoide_acp
graph_kmedoide_acp <- ggplot() +
geom_point(data = dataACP,
aes(x = Dim.1, y = Dim.2, col = groupe_kmedoide), alpha = 0.45) +
geom_point(data =medoide_ACP, aes(x = Dim.1, y = Dim.2) color = "black", shape = 4, size = 4 )+
graph_kmedoide_acp <- ggplot() +
geom_point(data = dataACP,
aes(x = Dim.1, y = Dim.2, col = groupe_kmedoide), alpha = 0.45) +
geom_point(data =medoide_ACP, aes(x = Dim.1, y = Dim.2), color = "black", shape = 4, size = 4 )+
xlab("Dimension 1") +
ylab("Dimension 2") +
labs(color = "Groupes K-médoïdes") +
theme_bw() +
theme(plot.title = element_text(hjust = 0.5, face = "bold"))
graph_kmedoide_acp
graph_kmedoide_acp <- ggplot() +
geom_point(data = dataACP,
aes(x = Dim.1, y = Dim.2, col = groupe_kmedoide), alpha = 0.45) +
geom_point(data =medoide_ACP, aes(x = Dim.1, y = Dim.2), color = "black", shape = 4, size = 4 )+
xlab("Dimension 1") +
ylab("Dimension 2") +
labs(color = "Groupes K-médoïdes", shape="Centroïdes") +
theme_bw() +
theme(plot.title = element_text(hjust = 0.5, face = "bold"))
graph_kmedoide_acp
graph_kmedoide_acp <- ggplot() +
geom_point(data = dataACP,
aes(x = Dim.1, y = Dim.2, col = groupe_kmedoide), alpha = 0.45) +
geom_point(data =medoide_ACP, aes(x = Dim.1, y = Dim.2), color = "black", shape = 4, size = 4 )+
xlab("Dimension 1") +
ylab("Dimension 2") +
labs(color = "Groupes K-médoïdes", shape="Centroïdes") +
theme_bw() +
theme(plot.title = element_text(hjust = 0.5, face = "bold"))+
scale_shape_manual(values = c(4), labels = c("Centroides"))
graph_kmedoide_acp
graph_kmedoide_acp <- ggplot() +
geom_point(data = dataACP,
aes(x = Dim.1, y = Dim.2, col = groupe_kmedoide), alpha = 0.45) +
geom_point(data = medoide_ACP, aes(x = Dim.1, y = Dim.2, shape = "Centroïdes"), color = "black", size = 4) +
xlab("Dimension 1") +
ylab("Dimension 2") +
labs(color = "Groupes K-médoïdes", shape = "Centroïdes") +
theme_bw() +
theme(plot.title = element_text(hjust = 0.5, face = "bold")) +
scale_shape_manual(values = c(4))
graph_kmedoide_acp
graph_kmedoide_acp <- ggplot() +
geom_point(data = dataACP,
aes(x = Dim.1, y = Dim.2, col = groupe_kmedoide), alpha = 0.45) +
geom_point(data = medoide_ACP, aes(x = Dim.1, y = Dim.2, shape = "Centroïdes"), color = "black", size = 4) +
xlab("Dimension 1") +
ylab("Dimension 2") +
labs(color = "Groupes K-médoïdes", shape = "Centroïdes") +
theme_bw() +
theme(plot.title = element_text(hjust = 0.5, face = "bold"), legend.position = "Bottom") +
scale_shape_manual(values = c(4))
graph_kmedoide_acp
df_centroide <- Datajoined[c(3069,1138),c("VehClass","VehPower","VehGas","VehAge","DrivGender","DrivAge","BonusMalus","LicenceNb")]
df_centroide <- Datajoined[c(3069,1138),c("VehClass","VehPower","VehGas","VehAge","DrivGender","DrivAge","BonusMalus","LicenceNb")]
df_centroide <- Datajoined[c(3069,1138),c("VehClass","VehPower","VehGas","VehAge","DrivGender","DrivAge","BonusMalus","LicenceNb")]
df_centroide
df_centroide <- Datajoined[c(3069,1138),c("VehClass","VehPower","VehGas","VehAge","DrivGender","DrivAge","BonusMalus","LicenceNb")]
medoide
rownames(df_centroide) <- c("Centroïde groupe 1","Centroïde groupe 2")
df_centroide
graph_kmedoide_acp <- ggplot() +
geom_point(data = dataACP,
aes(x = Dim.1, y = Dim.2, col = groupe_kmedoide), alpha = 0.45) +
geom_point(data = medoide_ACP, aes(x = Dim.1, y = Dim.2, shape = "Centroïdes"), color = "black", size = 4) +
xlab("Dimension 1") +
ylab("Dimension 2") +
labs(color = "Groupes K-médoïdes", shape = "Centroïdes") +
theme_bw() +
theme(plot.title = element_text(hjust = 0.5, face = "bold"), legend.position = "bottom") +
scale_shape_manual(values = c(4))
graph_kmedoide_acp
graph_kmedoide_acp <- ggplot() +
geom_point(data = dataACP,
aes(x = Dim.1, y = Dim.2, col = groupe_kmedoide), alpha = 0.45) +
geom_point(data = medoide_ACP, aes(x = Dim.1, y = Dim.2, shape = "Centroïdes"), color = "black", size = 4) +
xlab("Dimension 1") +
ylab("Dimension 2") +
labs(color = "Groupes K-médoïdes", shape = "Centroïdes") +
theme_bw() +
theme(plot.title = element_text(hjust = 0.5, face = "bold"), legend.position = "top right") +
scale_shape_manual(values = c(4))
graph_kmedoide_acp
graph_kmedoide_acp <- ggplot() +
geom_point(data = dataACP,
aes(x = Dim.1, y = Dim.2, col = groupe_kmedoide), alpha = 0.45) +
geom_point(data = medoide_ACP, aes(x = Dim.1, y = Dim.2, shape = "Centroïdes"), color = "black", size = 4) +
xlab("Dimension 1") +
ylab("Dimension 2") +
labs(color = "Groupes K-médoïdes", shape = "Centroïdes") +
theme_bw() +
theme(plot.title = element_text(hjust = 0.5, face = "bold"), legend.position = "topright") +
scale_shape_manual(values = c(4))
graph_kmedoide_acp
graph_kmedoide_acp <- ggplot() +
geom_point(data = dataACP,
aes(x = Dim.1, y = Dim.2, col = groupe_kmedoide), alpha = 0.45) +
geom_point(data = medoide_ACP, aes(x = Dim.1, y = Dim.2, shape = "Centroïdes"), color = "black", size = 4) +
xlab("Dimension 1") +
ylab("Dimension 2") +
labs(color = "Groupes K-médoïdes", shape = "Centroïdes") +
theme_bw() +
theme(plot.title = element_text(hjust = 0.5, face = "bold"), legend.position = "top-right") +
scale_shape_manual(values = c(4))
graph_kmedoide_acp
graph_kmedoide_acp <- ggplot() +
geom_point(data = dataACP,
aes(x = Dim.1, y = Dim.2, col = groupe_kmedoide), alpha = 0.45) +
geom_point(data = medoide_ACP, aes(x = Dim.1, y = Dim.2, shape = "Centroïdes"), color = "black", size = 4) +
xlab("Dimension 1") +
ylab("Dimension 2") +
labs(color = "Groupes K-médoïdes", shape = "Centroïdes") +
theme_bw() +
theme(plot.title = element_text(hjust = 0.5, face = "bold"), legend.position = "topright") +
scale_shape_manual(values = c(4))
graph_kmedoide_acp
graph_kmedoide_acp <- ggplot() +
geom_point(data = dataACP,
aes(x = Dim.1, y = Dim.2, col = groupe_kmedoide), alpha = 0.45) +
geom_point(data = medoide_ACP, aes(x = Dim.1, y = Dim.2, shape = "Centroïdes"), color = "black", size = 4) +
xlab("Dimension 1") +
ylab("Dimension 2") +
labs(color = "Groupes K-médoïdes", shape = "Centroïdes") +
theme_bw() +
theme(plot.title = element_text(hjust = 0.5, face = "bold"), legend.position = c(0.9,0.9)) +
scale_shape_manual(values = c(4))
graph_kmedoide_acp
graph_kmedoide_acp <- ggplot() +
geom_point(data = dataACP,
aes(x = Dim.1, y = Dim.2, col = groupe_kmedoide), alpha = 0.45) +
geom_point(data = medoide_ACP, aes(x = Dim.1, y = Dim.2, shape = "Centroïdes"), color = "black", size = 4) +
xlab("Dimension 1") +
ylab("Dimension 2") +
labs(color = "Groupes K-médoïdes", shape = "Centroïdes") +
theme_bw() +
theme(plot.title = element_text(hjust = 0.5, face = "bold"), legend.position = c(1,1)) +
scale_shape_manual(values = c(4))
graph_kmedoide_acp
theme(plot.title = element_text(hjust = 0.5, face = "bold"), legend.position = c(0.7,0.7) +
graph_kmedoide_acp
graph_kmedoide_acp <- ggplot() +
graph_kmedoide_acp
graph_kmedoide_acp <- ggplot() +
geom_point(data = dataACP,
aes(x = Dim.1, y = Dim.2, col = groupe_kmedoide), alpha = 0.45) +
geom_point(data = medoide_ACP, aes(x = Dim.1, y = Dim.2, shape = "Centroïdes"), color = "black", size = 4) +
xlab("Dimension 1") +
ylab("Dimension 2") +
labs(color = "Groupes K-médoïdes", shape = "Centroïdes") +
theme_bw() +
theme(plot.title = element_text(hjust = 0.5, face = "bold"), legend.position = c(0.9,0.9)) +
scale_shape_manual(values = c(4))
graph_kmedoide_acp
graph_kmedoide_acp <- ggplot() +
geom_point(data = dataACP,
aes(x = Dim.1, y = Dim.2, col = groupe_kmedoide), alpha = 0.45) +
geom_point(data = medoide_ACP, aes(x = Dim.1, y = Dim.2, shape = "Centroïdes"), color = "black", size = 4) +
xlab("Dimension 1") +
ylab("Dimension 2") +
labs(color = "Groupes K-médoïdes", shape = "Centroïdes") +
theme_bw() +
theme(plot.title = element_text(hjust = 0.5, face = "bold"), legend.position = c(0.9,0.85)) +
scale_shape_manual(values = c(4))
graph_kmedoide_acp
graph_kmedoide_acp <- ggplot() +
geom_point(data = dataACP,
aes(x = Dim.1, y = Dim.2, col = groupe_kmedoide), alpha = 0.45) +
geom_point(data = medoide_ACP, aes(x = Dim.1, y = Dim.2, shape = "Centroïdes"), color = "black", size = 4) +
xlab("Dimension 1") +
ylab("Dimension 2") +
labs(color = "Groupes K-médoïdes", shape = "Centroïdes") +
theme_bw() +
theme(plot.title = element_text(hjust = 0.5, face = "bold"), legend.position = "toprigth") +
scale_shape_manual(values = c(4))
graph_kmedoide_acp
graph_kmedoide_acp <- ggplot() +
geom_point(data = dataACP,
aes(x = Dim.1, y = Dim.2, col = groupe_kmedoide), alpha = 0.45) +
geom_point(data = medoide_ACP, aes(x = Dim.1, y = Dim.2, shape = "Centroïdes"), color = "black", size = 4) +
xlab("Dimension 1") +
ylab("Dimension 2") +
labs(color = "Groupes K-médoïdes", shape = "Centroïdes") +
theme_bw() +
theme(plot.title = element_text(hjust = 0.5, face = "bold"),
legend.position = c(1, 1),
legend.justification = c(1, 1)) +
scale_shape_manual(values = c(4))
graph_kmedoide_acp
graph_kmedoide_acp <- ggplot() +
geom_point(data = dataACP,
aes(x = Dim.1, y = Dim.2, col = groupe_kmedoide), alpha = 0.45) +
geom_point(data = medoide_ACP, aes(x = Dim.1, y = Dim.2, shape = "Centroïdes"), color = "black", size = 4) +
xlab("Dimension 1") +
ylab("Dimension 2") +
labs(color = "Groupes K-médoïdes", shape = "Centroïdes") +
theme_bw() +
theme(plot.title = element_text(hjust = 0.5, face = "bold"),
legend.position = c(0.9, 0.9),
legend.justification = c(1, 1)) +
scale_shape_manual(values = c(4))
graph_kmedoide_acp
graph_kmedoide_acp <- ggplot() +
geom_point(data = dataACP,
aes(x = Dim.1, y = Dim.2, col = groupe_kmedoide), alpha = 0.45) +
geom_point(data = medoide_ACP, aes(x = Dim.1, y = Dim.2, shape = "Centroïdes"), color = "black", size = 4) +
xlab("Dimension 1") +
ylab("Dimension 2") +
labs(color = "Groupes K-médoïdes", shape = "Centroïdes") +
theme_bw() +
theme(plot.title = element_text(hjust = 0.5, face = "bold"),
legend.position = c(0.9, 0.98),
legend.justification = c(1, 1)) +
scale_shape_manual(values = c(4))
graph_kmedoide_acp
graph_kmedoide_acp <- ggplot() +
geom_point(data = dataACP,
aes(x = Dim.1, y = Dim.2, col = groupe_kmedoide), alpha = 0.45) +
geom_point(data = medoide_ACP, aes(x = Dim.1, y = Dim.2, shape = "Centroïdes"), color = "black", size = 4) +
xlab("Dimension 1") +
ylab("Dimension 2") +
labs(color = "Groupes K-médoïdes", shape = "Centroïdes") +
theme_bw() +
theme(plot.title = element_text(hjust = 0.5, face = "bold"),
legend.position = c(0.9, 0.999),
legend.justification = c(1, 1)) +
scale_shape_manual(values = c(4))
graph_kmedoide_acp
centroides <- kmedoide$id.med
centroide_ACP <- dataACP[centroides, c("Dim.1","Dim.2")]
graph_kmedoide_acp <- ggplot() +
geom_point(dataACP,
aes(x = Dim.1, y = Dim.2, col = groupe_kmedoide), alpha = 0.45) +
geom_point(centroide_ACP, aes(x = Dim.1, y = Dim.2), color = "black", shape = 4)
graph_kmedoide_acp <- ggplot() +
geom_point(dataACP,
aes(x = Dim.1, y = Dim.2, col = groupe_kmedoide), alpha = 0.45) +
geom_point(centroide_ACP, aes(x = Dim.1, y = Dim.2), color = "black", shape = 4)+
labs(color = "Groupes K-médoïdes", x= "Dimension 1", y = "Dimension 2") +
theme_bw() +
theme(plot.title = element_text(hjust = 0.5, face = "bold"),
legend.position = c(0.9, 0.997),
legend.justification = c(1, 1)) + scale_shape_manual(values = c(4), labels = c("Centroïdes"))
graph_kmedoide_acp <- ggplot() +
geom_point(dataACP,
aes(x = Dim.1, y = Dim.2, col = groupe_kmedoide), alpha = 0.45) +
geom_point(data = centroide_ACP, aes(x = Dim.1, y = Dim.2), color = "black", shape = 4)+
labs(color = "Groupes K-médoïdes", x= "Dimension 1", y = "Dimension 2") +
theme_bw() +
theme(plot.title = element_text(hjust = 0.5, face = "bold"),
legend.position = c(0.9, 0.997),
legend.justification = c(1, 1)) + scale_shape_manual(values = c(4), labels = c("Centroïdes"))
graph_kmedoide_acp <- ggplot() +
geom_point(data =dataACP,
aes(x = Dim.1, y = Dim.2, col = groupe_kmedoide), alpha = 0.45) +
geom_point(data = centroide_ACP, aes(x = Dim.1, y = Dim.2), color = "black", shape = 4)+
labs(color = "Groupes K-médoïdes", x= "Dimension 1", y = "Dimension 2") +
theme_bw() +
theme(plot.title = element_text(hjust = 0.5, face = "bold"),
legend.position = c(0.9, 0.997),
legend.justification = c(1, 1)) + scale_shape_manual(values = c(4), labels = c("Centroïdes"))
graph_kmedoide_acp
graph_kmedoide_acp <- ggplot() +
geom_point(data =dataACP,
aes(x = Dim.1, y = Dim.2, col = groupe_kmedoide), alpha = 0.45) +
geom_point(data = centroide_ACP, aes(x = Dim.1, y = Dim.2), color = "black", shape = 4, size =6)+
labs(color = "Groupes K-médoïdes", x= "Dimension 1", y = "Dimension 2") +
theme_bw() +
theme(plot.title = element_text(hjust = 0.5, face = "bold"),
legend.position = c(0.9, 0.997),
legend.justification = c(1, 1)) + scale_shape_manual(values = c(4), labels = c("Centroïdes"))
graph_kmedoide_acp
graph_kmedoide_acp <- ggplot() +
geom_point(data =dataACP,
aes(x = Dim.1, y = Dim.2, col = groupe_kmedoide), alpha = 0.45) +
geom_point(data = centroide_ACP, aes(x = Dim.1, y = Dim.2), color = "black", shape = 4, size =6)+
labs(color = "Groupes K-médoïdes",shape = "Centroïdes", x= "Dimension 1", y = "Dimension 2") +
theme_bw() +
theme(plot.title = element_text(hjust = 0.5, face = "bold"),
legend.position = c(0.9, 0.997),
legend.justification = c(1, 1)) + scale_shape_manual(values = c(4), labels = c("Centroïdes"))
graph_kmedoide_acp
graph_kmedoide_acp <- ggplot() +
geom_point(data =dataACP,
aes(x = Dim.1, y = Dim.2, col = groupe_kmedoide), alpha = 0.45) +
geom_point(data = centroide_ACP, aes(x = Dim.1, y = Dim.2), color = "black", shape = 4, size =6)+
labs(color = "Groupes K-médoïdes",shape = "Centroïdes", x= "Dimension 1", y = "Dimension 2") +
theme_bw() +
theme(plot.title = element_text(hjust = 0.5, face = "bold"),
legend.position = c(0.9, 0.997),
legend.justification = c(1, 1)) + scale_shape_manual(values = c(4))
graph_kmedoide_acp
graph_kmedoide_acp <- ggplot() +
geom_point(data =dataACP,
aes(x = Dim.1, y = Dim.2, col = groupe_kmedoide), alpha = 0.45) +
geom_point(data = centroide_ACP, aes(x = Dim.1, y = Dim.2, shape = "Centroïdes"), color = "black", shape = 4, size =6)+
labs(color = "Groupes K-médoïdes",shape = "Centroïdes", x= "Dimension 1", y = "Dimension 2") +
theme_bw() +
theme(plot.title = element_text(hjust = 0.5, face = "bold"),
legend.position = c(0.9, 0.997),
legend.justification = c(1, 1)) + scale_shape_manual(values = c(4))
graph_kmedoide_acp
graph_kmedoide_acp <- ggplot() +
geom_point(data =dataACP,
aes(x = Dim.1, y = Dim.2, col = groupe_kmedoide), alpha = 0.45) +
geom_point(data = centroide_ACP, aes(x = Dim.1, y = Dim.2, shape = "Centroïdes"), color = "black", size =6)+
labs(color = "Groupes K-médoïdes",shape = "Centroïdes", x= "Dimension 1", y = "Dimension 2") +
theme_bw() +
theme(plot.title = element_text(hjust = 0.5, face = "bold"),
legend.position = c(0.9, 0.997),
legend.justification = c(1, 1)) + scale_shape_manual(values = c(4))
graph_kmedoide_acp
df_centroide <- Datajoined[centroides,c("VehClass","VehPower","VehGas","VehAge","DrivGender","DrivAge","BonusMalus","LicenceNb")]
rownames(df_centroide) <- c("Centroïde groupe 1","Centroïde groupe 2")
df_centroide
setwd("~/Apprentissage/536996777_tp4114/Rapport_Partie2")
library(readxl)
# Importer l'ensemble du fichier Excel
data <- read_excel("Données TP GRF2 (version 2).xlsb")
setwd("~/GRF2/TPGRF2")
# Importer l'ensemble du fichier Excel
data <- read_excel("Données TP GRF2 (version 2).xlsb")
data <- read_excel("Données TP GRF2 (version 2).xlsb")
data <- read_excel("Données TP GRF2 (version 2).xlsb")
data <- read_excel("Données TP GRF2 (version 2).xlsb")
library(readxlsb)
install.packages("readxlsb")
library(readxlsb)
install.packages("readxlsb")
